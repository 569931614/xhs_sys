
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.github.io
 */

import{_ as P}from"./index.vue_vue_type_script_setup_true_lang-BkBSJsBX.js";import{d as R,r as y,m as K,a as G,p as r,g as O,c as J,b as t,w as a,h as f,t as Q,e as C,G as d,N as W,j as X,_ as Y,k as D}from"./index-CnisIzlN.js";import{a as b}from"./coze-Br_YcUzB.js";const Z=C("div",{class:"flex items-center gap-4"},"Coze配置",-1),ee=C("div",{class:"text-sm/6"},[C("div",null," 管理 Coze Bot 的密钥和配置。您可以添加多个 Coze Bot，方便在不同场景下使用。 ")],-1),te={class:"flex justify-end mt-5"},le=R({__name:"coze",setup(oe){const w=y([]),z=y(0),x={botId:[{required:!0,message:"请输入Bot ID",trigger:"blur"}],name:[{required:!0,message:"请输入名称",trigger:"blur"}],publicKey:[{required:!0,message:"请输入公钥",trigger:"blur"}],secretKey:[{required:!0,message:"请输入私钥",trigger:"blur"}],clientId:[{required:!0,message:"请输入Client ID",trigger:"blur"}],spaceId:[{required:!0,message:"请输入Space ID",trigger:"blur"}]},i=K({page:1,size:10}),p=y(!1),v=y("添加Coze配置"),e=K({id:void 0,botId:"",name:"",publicKey:"",secretKey:"",clientId:"",spaceId:"",status:1}),_=y(),m=async()=>{try{const n=await b.getCozeList(i);n&&n.items&&(w.value=n.items,z.value=n.total)}catch(n){console.error("获取Coze列表失败",n),d.error("获取Coze列表失败")}},U=()=>{v.value="添加Coze配置",V(),p.value=!0},B=async n=>{v.value="编辑Coze配置",V();try{const l=await b.getCozeDetail(n.id);l&&Object.assign(e,l),p.value=!0}catch(l){console.error("获取Coze详情失败",l),d.error("获取Coze详情失败")}},k=n=>{W.confirm("确定要删除该Coze配置吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{await b.deleteCoze(n.id),d.success("删除成功"),m()}catch(l){console.error("删除Coze配置失败",l),d.error("删除Coze配置失败")}}).catch(()=>{})},S=async n=>{try{await b.updateCoze(n.id,{status:n.status===1?0:1}),d.success("状态更新成功"),m()}catch(l){console.error("更新状态失败",l),d.error("更新状态失败")}},V=()=>{e.id=void 0,e.botId="",e.name="",e.publicKey="",e.secretKey="",e.clientId="",e.spaceId="",e.status=1,_.value&&_.value.resetFields()},q=async()=>{_.value&&_.value.validate(async n=>{if(n)try{e.id?(await b.updateCoze(e.id,{botId:e.botId,name:e.name,publicKey:e.publicKey,secretKey:e.secretKey,clientId:e.clientId,spaceId:e.spaceId,status:e.status}),d.success("更新成功")):(await b.addCoze({botId:e.botId,name:e.name,publicKey:e.publicKey,secretKey:e.secretKey,clientId:e.clientId,spaceId:e.spaceId}),d.success("添加成功")),p.value=!1,m()}catch(l){console.error("保存Coze配置失败",l),d.error("保存Coze配置失败")}})},$=n=>{i.size=n,m()},j=n=>{i.page=n,m()};return G(()=>{m()}),(n,l)=>{const E=X,N=Y,T=P,s=r("el-table-column"),c=r("el-input"),h=r("el-switch"),I=r("el-button"),A=r("el-table"),F=r("el-pagination"),L=r("el-card"),u=r("el-form-item"),M=r("el-form"),H=r("el-dialog");return O(),J("div",null,[t(T,null,{title:a(()=>[Z]),content:a(()=>[ee]),default:a(()=>[t(N,{onClick:U},{default:a(()=>[t(E,{name:"i-material-symbols:add-circle-outline"}),f(" 添加配置 ")]),_:1})]),_:1}),t(L,{style:{margin:"20px"}},{default:a(()=>[t(A,{data:w.value,border:"",style:{width:"100%"}},{default:a(()=>[t(s,{prop:"id",label:"ID",width:"80"}),t(s,{prop:"name",label:"名称",width:"180"}),t(s,{prop:"botId",label:"Bot ID"}),t(s,{prop:"clientId",label:"Client ID"}),t(s,{prop:"spaceId",label:"Space ID"}),t(s,{prop:"publicKey",label:"公钥","show-overflow-tooltip":""}),t(s,{prop:"secretKey",label:"私钥","show-overflow-tooltip":""},{default:a(o=>[t(c,{modelValue:o.row.secretKey,"onUpdate:modelValue":g=>o.row.secretKey=g,disabled:"",type:"password","show-password":""},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(s,{prop:"status",label:"状态",width:"120"},{default:a(o=>[t(h,{modelValue:o.row.status,"onUpdate:modelValue":g=>o.row.status=g,"active-value":1,"inactive-value":0,onChange:()=>S(o.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),t(s,{prop:"createdAt",label:"创建时间",width:"180"},{default:a(o=>[f(Q(new Date(o.row.createdAt).toLocaleString()),1)]),_:1}),t(s,{label:"操作",width:"180"},{default:a(o=>[t(I,{size:"small",onClick:g=>B(o.row)},{default:a(()=>[f("编辑")]),_:2},1032,["onClick"]),t(I,{size:"small",type:"danger",onClick:g=>k(o.row)},{default:a(()=>[f("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),C("div",te,[t(F,{"current-page":i.page,"onUpdate:currentPage":l[0]||(l[0]=o=>i.page=o),"page-size":i.size,"onUpdate:pageSize":l[1]||(l[1]=o=>i.size=o),total:z.value,"page-sizes":[10,20,30,50],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:$,onCurrentChange:j},null,8,["current-page","page-size","total"])])]),_:1}),t(H,{modelValue:p.value,"onUpdate:modelValue":l[10]||(l[10]=o=>p.value=o),title:v.value,width:"500px"},{default:a(()=>[t(M,{ref_key:"formRef",ref:_,model:e,rules:x,"label-width":"100px",style:{"max-width":"500px"}},{default:a(()=>[t(u,{label:"名称",prop:"name"},{default:a(()=>[t(c,{modelValue:e.name,"onUpdate:modelValue":l[2]||(l[2]=o=>e.name=o),placeholder:"请输入名称"},null,8,["modelValue"])]),_:1}),t(u,{label:"Bot ID",prop:"botId"},{default:a(()=>[t(c,{modelValue:e.botId,"onUpdate:modelValue":l[3]||(l[3]=o=>e.botId=o),placeholder:"请输入Bot ID"},null,8,["modelValue"])]),_:1}),t(u,{label:"Client ID",prop:"clientId"},{default:a(()=>[t(c,{modelValue:e.clientId,"onUpdate:modelValue":l[4]||(l[4]=o=>e.clientId=o),placeholder:"请输入Client ID"},null,8,["modelValue"])]),_:1}),t(u,{label:"Space ID",prop:"spaceId"},{default:a(()=>[t(c,{modelValue:e.spaceId,"onUpdate:modelValue":l[5]||(l[5]=o=>e.spaceId=o),placeholder:"请输入Space ID"},null,8,["modelValue"])]),_:1}),t(u,{label:"公钥",prop:"publicKey"},{default:a(()=>[t(c,{modelValue:e.publicKey,"onUpdate:modelValue":l[6]||(l[6]=o=>e.publicKey=o),placeholder:"请输入公钥"},null,8,["modelValue"])]),_:1}),t(u,{label:"私钥",prop:"secretKey"},{default:a(()=>[t(c,{modelValue:e.secretKey,"onUpdate:modelValue":l[7]||(l[7]=o=>e.secretKey=o),placeholder:"请输入私钥",type:"password","show-password":""},null,8,["modelValue"])]),_:1}),t(u,{label:"状态",prop:"status"},{default:a(()=>[t(h,{modelValue:e.status,"onUpdate:modelValue":l[8]||(l[8]=o=>e.status=o),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1}),t(u,null,{default:a(()=>[t(I,{type:"primary",onClick:q},{default:a(()=>[f("确定")]),_:1}),t(I,{onClick:l[9]||(l[9]=o=>p.value=!1)},{default:a(()=>[f("取消")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}});typeof D=="function"&&D(le);export{le as default};
