
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.github.io
 */

import{d as G,r as k,m as w,U as T,E as y,p as i,g as B,c as R,b as t,w as a,_ as J,j as Q,h,F as W,s as Y,i as Z,e as v,I as ee,bX as te,k as A}from"./index-CnisIzlN.js";import{_ as le}from"./index.vue_vue_type_script_setup_true_lang-BkBSJsBX.js";import{T as oe,r as V,B as ae}from"./service-BAUdoYLG.js";import{u as ne}from"./use-message-DYMqPvJU.js";import"./DataTable-0DEKN-Ju.js";import"./Icon-BI3nzoj7.js";import"./composables-D2s7nT97.js";const se=v("div",{class:"flex items-center gap-4"},"笔记类型管理",-1),re=v("div",{class:"text-sm/6"},[v("div",null," 管理小红书笔记的分类类型，用于对笔记进行分类。 ")],-1),ie={class:"dialog-footer"},ue=G({__name:"notetype",setup(de){const c=k(),m=ne(),x=k(),d=k(!1),b=k(!1),N=[{label:"启用",value:!0},{label:"禁用",value:!1}],u=w({name:"",status:null}),l=w({id:"",name:"",description:"",sort:0,status:!0}),P={name:{required:!0,message:"请输入类型名称",trigger:"blur"}},$=[{title:"ID",key:"id",width:80},{title:"类型名称",key:"name",width:150},{title:"描述",key:"description",width:200},{title:"排序",key:"sort",width:100},{title:"状态",key:"status",width:100,render(e){return T("span",{style:{color:e.status?"green":"red"}},e.status?"启用":"禁用")}},{title:"创建时间",key:"createTime",width:180}],q=w({width:260,title:"操作",key:"action",fixed:"right",render(e){return T(oe,{style:"button",actions:[{label:"编辑",onClick:j.bind(null,e),type:"primary"},{label:"删除",onClick:L.bind(null,e),type:"error"}]})}});function D(e){console.log(e)}async function F(e){try{const o={...e,...u},p=await V({url:"/xiaohongshu/notetype/list",method:"get",params:o});console.log("API返回数据:",p);const n=p;let r={items:[],total:0};if(n&&typeof n=="object"){if(n.data&&n.data.items)r={items:n.data.items||[],total:n.data.total||0};else if(n.items)r={items:n.items||[],total:n.total||0};else if(Array.isArray(n)){const f=[];for(let _=0;_<n.length;_++)f.push(n[_]);r={items:f,total:f.length}}}return console.log("处理后的数据:",r),r}catch(o){return console.error("加载数据失败:",o),{items:[],total:0}}}function I(){y(()=>{var e;(e=c.value)==null||e.reload()})}function M(){u.name="",u.status=null,y(()=>{var e;(e=c.value)==null||e.reload()})}function E(){d.value=!0,l.id="",l.name="",l.description="",l.sort=0,l.status=!0,y(()=>{console.log("nextTick后showModal状态:",d.value)})}function j(e){d.value=!0,l.id=e.id,l.name=e.name,l.description=e.description,l.sort=e.sort,l.status=e.status}async function L(e){try{await V({url:`/xiaohongshu/notetype/delete/${e.id}`,method:"delete"}),m.success("删除成功"),y(()=>{var o;(o=c.value)==null||o.reload()})}catch{m.error("删除失败")}}function S(){d.value=!1}async function H(){console.log("confirmForm 函数被调用");try{if(b.value=!0,console.log("表单数据:",l),!l.name){m.error("请输入类型名称"),b.value=!1;return}const e={...l,sort:Number(l.sort),status:!!l.status};e.id===""?delete e.id:e.id=Number(e.id);const o=e.id?"/xiaohongshu/notetype/update":"/xiaohongshu/notetype/create",p=await V({url:o,method:"post",data:e});m.success(e.id?"更新成功":"添加成功"),d.value=!1,y(()=>{var n;(n=c.value)==null||n.reload()})}catch(e){console.error("保存失败:",e),m.error(l.id?"更新失败":"添加失败")}finally{b.value=!1}}return(e,o)=>{const p=le,n=i("el-input"),r=i("el-form-item"),f=i("el-option"),_=i("el-select"),g=i("el-button"),C=i("el-form"),U=ee,K=te,O=i("el-input-number"),X=i("el-switch"),z=i("el-dialog");return B(),R("div",null,[t(p,null,{title:a(()=>[se]),content:a(()=>[re]),default:a(()=>[t(J,{outline:"",type:"success",onClick:E},{default:a(()=>[t(Q,{name:"i-ri:file-text-line"}),h(" 新增笔记类型 ")]),_:1})]),_:1}),t(U,null,{default:a(()=>[t(C,{ref_key:"formRef",ref:x,inline:!0,model:u},{default:a(()=>[t(r,{label:"类型名称"},{default:a(()=>[t(n,{modelValue:u.name,"onUpdate:modelValue":o[0]||(o[0]=s=>u.name=s),placeholder:"请输入类型名称",clearable:""},null,8,["modelValue"])]),_:1}),t(r,{label:"状态"},{default:a(()=>[t(_,{modelValue:u.status,"onUpdate:modelValue":o[1]||(o[1]=s=>u.status=s),placeholder:"请选择状态",clearable:"",style:{width:"160px"}},{default:a(()=>[(B(),R(W,null,Y(N,s=>t(f,{key:String(s.value),label:s.label,value:s.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),t(r,null,{default:a(()=>[t(g,{type:"primary",onClick:I},{default:a(()=>[h("搜索")]),_:1}),t(g,{onClick:M},{default:a(()=>[h("重置")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(U,{style:{width:"100%"}},{default:a(()=>[t(K,null,{default:a(()=>[t(Z(ae),{columns:$,request:F,"row-key":s=>s.id,ref_key:"actionRef",ref:c,actionColumn:q,"onUpdate:checkedRowKeys":D,"scroll-x":1090},null,8,["row-key","actionColumn"])]),_:1}),t(z,{modelValue:d.value,"onUpdate:modelValue":o[6]||(o[6]=s=>d.value=s),title:"笔记类型信息",width:"600px","close-on-click-modal":!1},{footer:a(()=>[v("div",ie,[t(g,{onClick:S},{default:a(()=>[h("取消")]),_:1}),t(g,{type:"primary",loading:b.value,onClick:H},{default:a(()=>[h("确定")]),_:1},8,["loading"])])]),default:a(()=>[t(C,{model:l,rules:P,ref_key:"formRef",ref:x,"label-width":"80px",class:"py-4"},{default:a(()=>[t(r,{label:"类型名称",prop:"name"},{default:a(()=>[t(n,{modelValue:l.name,"onUpdate:modelValue":o[2]||(o[2]=s=>l.name=s),placeholder:"请输入类型名称"},null,8,["modelValue"])]),_:1}),t(r,{label:"描述",prop:"description"},{default:a(()=>[t(n,{modelValue:l.description,"onUpdate:modelValue":o[3]||(o[3]=s=>l.description=s),type:"textarea",placeholder:"请输入类型描述",rows:3},null,8,["modelValue"])]),_:1}),t(r,{label:"排序",prop:"sort"},{default:a(()=>[t(O,{modelValue:l.sort,"onUpdate:modelValue":o[4]||(o[4]=s=>l.sort=s),placeholder:"请输入排序值"},null,8,["modelValue"])]),_:1}),t(r,{label:"状态",prop:"status"},{default:a(()=>[t(X,{modelValue:l.status,"onUpdate:modelValue":o[5]||(o[5]=s=>l.status=s)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])]),_:1})])}}});typeof A=="function"&&A(ue);export{ue as default};
