
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.github.io
 */

import{d as b,r as i,a as z,Y as B,g as v,c as x,Z as M,$ as P,i as n,l as R,Q as T,f as L,O as A,a0 as I,p as r,b as e,w as t,h as g,L as N,G as F,I as G,k as h}from"./index-CnisIzlN.js";import{_ as O}from"./index.vue_vue_type_script_setup_true_lang-BkBSJsBX.js";const Q=b({name:"FixedActionBar",__name:"index",setup(y){const p=i(!1);z(()=>{d(),window.addEventListener("scroll",d)}),B(()=>{window.removeEventListener("scroll",d)});function d(){const c=document.documentElement.scrollTop||document.body.scrollTop,a=document.documentElement.clientHeight||document.body.clientHeight,o=document.documentElement.scrollHeight||document.body.scrollHeight;p.value=Math.ceil(c+a)>=o}return(c,a)=>(v(),x("div",{class:P(["fixed-action-bar bottom-0 z-4 bg-[var(--g-container-bg)] p-5 text-center transition",{shadow:!n(p)}]),"data-fixed-calc-width":""},[M(c.$slots,"default",{},void 0,!0)],2))}}),Y=R(Q,[["__scopeId","data-v-9af45002"]]),Z=b({__name:"edit.password",setup(y){const p=T(),d=L(),c=A(),a=i(),o=i({password:"",newpassword:"",checkpassword:""}),k=I(),V=i({password:[{required:!0,message:"请输入原密码",trigger:"blur"}],newpassword:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:6,max:18,trigger:"blur",message:"密码长度为6到18位"}],checkpassword:[{required:!0,message:"请输入新密码",trigger:"blur"},{validator:(m,s,l)=>{s!==o.value.newpassword?l(new Error("两次密码不一致！")):l()}}]});function E(){a.value&&a.value.validate(m=>{if(m){const{password:s,newpassword:l}=o.value;N.passwordEdit({oldPassword:s,password:l}).then(()=>{F({type:"success",message:"修改密码成功，请重新登录"}),c.logout().then(()=>{d.push({name:"login",query:{redirect:p.fullPath}})})})}})}function C(){k.reload()}return(m,s)=>{const l=O,_=r("el-input"),w=r("el-form-item"),H=r("el-form"),U=r("el-col"),S=r("el-row"),$=G,f=r("el-button"),q=Y;return v(),x("div",null,[e(l,{title:"修改密码",content:"定期修改密码可以提高帐号安全性噢~"}),e($,null,{default:t(()=>[e(S,null,{default:t(()=>[e(U,{md:24,lg:12},{default:t(()=>[e(H,{ref_key:"formRef",ref:a,model:n(o),rules:n(V),"label-width":"120px"},{default:t(()=>[e(w,{label:"原密码",prop:"password"},{default:t(()=>[e(_,{modelValue:n(o).password,"onUpdate:modelValue":s[0]||(s[0]=u=>n(o).password=u),type:"password",placeholder:"请输入原密码","show-password":""},null,8,["modelValue"])]),_:1}),e(w,{label:"新密码",prop:"newpassword"},{default:t(()=>[e(_,{modelValue:n(o).newpassword,"onUpdate:modelValue":s[1]||(s[1]=u=>n(o).newpassword=u),type:"password",placeholder:"请输入原密码","show-password":""},null,8,["modelValue"])]),_:1}),e(w,{label:"确认新密码",prop:"checkpassword"},{default:t(()=>[e(_,{modelValue:n(o).checkpassword,"onUpdate:modelValue":s[2]||(s[2]=u=>n(o).checkpassword=u),type:"password",placeholder:"请输入原密码","show-password":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1})]),_:1})]),_:1}),e(q,null,{default:t(()=>[e(f,{type:"primary",size:"large",onClick:E},{default:t(()=>[g(" 提交 ")]),_:1}),e(f,{type:"default",size:"large",onClick:C},{default:t(()=>[g(" 取消 ")]),_:1})]),_:1})])}}});typeof h=="function"&&h(Z);export{Z as default};
