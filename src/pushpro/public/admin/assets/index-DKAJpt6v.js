
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.github.io
 */

import{ax as p,az as c,ay as U,d as x,aA as rt,b7 as st,U as m,g as z,c as N,e as d,J as I,r as f,bG as lt,m as E,n as nt,a as it,b as e,w as a,i as t,x as dt,R as h,h as w,S as ut,T as pt,bH as ct,W as mt,X as ft,l as ht}from"./index-CnisIzlN.js";import{S as bt}from"./SearchOutlined-COBx1Us-.js";import{P as gt}from"./PlusOutlined-Dxy3EoIJ.js";import{N as vt}from"./InputNumber-nCSOSPO9.js";import{u as _t,a as v,b as k,d as V,c as yt}from"./use-message-DYMqPvJU.js";import{u as wt}from"./composables-D2s7nT97.js";import{N as _}from"./Icon-BI3nzoj7.js";import{N as xt,a as F,b as T}from"./DataTable-0DEKN-Ju.js";import{N as Ct,a as b}from"./FormItem-DswOIw46.js";const kt=p("input-group",`
 display: inline-flex;
 width: 100%;
 flex-wrap: nowrap;
 vertical-align: bottom;
`,[c(">",[p("input",[c("&:not(:last-child)",`
 border-top-right-radius: 0!important;
 border-bottom-right-radius: 0!important;
 `),c("&:not(:first-child)",`
 border-top-left-radius: 0!important;
 border-bottom-left-radius: 0!important;
 margin-left: -1px!important;
 `)]),p("button",[c("&:not(:last-child)",`
 border-top-right-radius: 0!important;
 border-bottom-right-radius: 0!important;
 `,[U("state-border, border",`
 border-top-right-radius: 0!important;
 border-bottom-right-radius: 0!important;
 `)]),c("&:not(:first-child)",`
 border-top-left-radius: 0!important;
 border-bottom-left-radius: 0!important;
 `,[U("state-border, border",`
 border-top-left-radius: 0!important;
 border-bottom-left-radius: 0!important;
 `)])]),c("*",[c("&:not(:last-child)",`
 border-top-right-radius: 0!important;
 border-bottom-right-radius: 0!important;
 `,[c(">",[p("input",`
 border-top-right-radius: 0!important;
 border-bottom-right-radius: 0!important;
 `),p("base-selection",[p("base-selection-label",`
 border-top-right-radius: 0!important;
 border-bottom-right-radius: 0!important;
 `),p("base-selection-tags",`
 border-top-right-radius: 0!important;
 border-bottom-right-radius: 0!important;
 `),U("box-shadow, border, state-border",`
 border-top-right-radius: 0!important;
 border-bottom-right-radius: 0!important;
 `)])])]),c("&:not(:first-child)",`
 margin-left: -1px!important;
 border-top-left-radius: 0!important;
 border-bottom-left-radius: 0!important;
 `,[c(">",[p("input",`
 border-top-left-radius: 0!important;
 border-bottom-left-radius: 0!important;
 `),p("base-selection",[p("base-selection-label",`
 border-top-left-radius: 0!important;
 border-bottom-left-radius: 0!important;
 `),p("base-selection-tags",`
 border-top-left-radius: 0!important;
 border-bottom-left-radius: 0!important;
 `),U("box-shadow, border, state-border",`
 border-top-left-radius: 0!important;
 border-bottom-left-radius: 0!important;
 `)])])])])])]),zt={},G=x({name:"InputGroup",props:zt,setup(n){const{mergedClsPrefixRef:i}=rt(n);return st("-input-group",kt,i),{mergedClsPrefix:i}},render(){const{mergedClsPrefix:n}=this;return m("div",{class:`${n}-input-group`},this.$slots)}}),Nt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},$t=d("path",{d:"M942.2 486.2C847.4 286.5 704.1 186 512 186c-192.2 0-335.4 100.5-430.2 300.3a60.3 60.3 0 0 0 0 51.5C176.6 737.5 319.9 838 512 838c192.2 0 335.4-100.5 430.2-300.3c7.7-16.2 7.7-35 0-51.5zM512 766c-161.3 0-279.4-81.8-362.7-254C232.6 339.8 350.7 258 512 258c161.3 0 279.4 81.8 362.7 254C791.5 684.2 673.4 766 512 766zm-4-430c-97.2 0-176 78.8-176 176s78.8 176 176 176s176-78.8 176-176s-78.8-176-176-176zm0 288c-61.9 0-112-50.1-112-112s50.1-112 112-112s112 50.1 112 112s-50.1 112-112 112z",fill:"currentColor"},null,-1),Pt=[$t],St=x({name:"EyeOutlined",render:function(i,C){return z(),N("svg",Nt,Pt)}}),Ut={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},Tt=d("path",{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0 0 42 42h216v494z",fill:"currentColor"},null,-1),It=[Tt],H=x({name:"FileOutlined",render:function(i,C){return z(),N("svg",Ut,It)}}),Mt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},Lt=d("path",{d:"M574 665.4a8.03 8.03 0 0 0-11.3 0L446.5 781.6c-53.8 53.8-144.6 59.5-204 0c-59.5-59.5-53.8-150.2 0-204l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3l-39.8-39.8a8.03 8.03 0 0 0-11.3 0L191.4 526.5c-84.6 84.6-84.6 221.5 0 306s221.5 84.6 306 0l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3L574 665.4zm258.6-474c-84.6-84.6-221.5-84.6-306 0L410.3 307.6a8.03 8.03 0 0 0 0 11.3l39.7 39.7c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c53.8-53.8 144.6-59.5 204 0c59.5 59.5 53.8 150.2 0 204L665.3 562.6a8.03 8.03 0 0 0 0 11.3l39.8 39.8c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c84.5-84.6 84.5-221.5 0-306.1zM610.1 372.3a8.03 8.03 0 0 0-11.3 0L372.3 598.7a8.03 8.03 0 0 0 0 11.3l39.6 39.6c3.1 3.1 8.2 3.1 11.3 0l226.4-226.4c3.1-3.1 3.1-8.2 0-11.3l-39.5-39.6z",fill:"currentColor"},null,-1),Ot=[Lt],Bt=x({name:"LinkOutlined",render:function(i,C){return z(),N("svg",Mt,Ot)}}),Dt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},Rt=d("path",{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448s448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372s372 166.6 372 372s-166.6 372-372 372z",fill:"currentColor"},null,-1),Vt=d("path",{d:"M623.6 316.7C593.6 290.4 554 276 512 276s-81.6 14.5-111.6 40.7C369.2 344 352 380.7 352 420v7.6c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V420c0-44.1 43.1-80 96-80s96 35.9 96 80c0 31.1-22 59.6-56.1 72.7c-21.2 8.1-39.2 22.3-52.1 40.9c-13.1 19-19.9 41.8-19.9 64.9V620c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8v-22.7a48.3 48.3 0 0 1 30.9-44.8c59-22.7 97.1-74.7 97.1-132.5c.1-39.3-17.1-76-48.3-103.3zM472 732a40 40 0 1 0 80 0a40 40 0 1 0-80 0z",fill:"currentColor"},null,-1),At=[Rt,Vt],Et=x({name:"QuestionCircleOutlined",render:function(i,C){return z(),N("svg",Dt,At)}}),Ft=n=>I.get("/customPage",{params:n}),Gt=n=>I.post("/customPage",n),Ht=(n,i)=>I.put(`/customPage/${n}`,i),jt=n=>I.delete(`/customPage/${n}`),$=n=>(mt("data-v-4a4e4f3b"),n=n(),ft(),n),Wt={class:"custom-page-container"},qt={class:"white-bg-container"},Kt={class:"data-table-wrapper"},Qt=$(()=>d("span",{class:"text-xs text-gray-500"}," 外部链接需要完整URL (如 https://example.com)，内部页面使用相对路径 (如 /help) ",-1)),Jt=$(()=>d("span",null,"外部链接",-1)),Xt=$(()=>d("span",null,"内部页面",-1)),Yt=$(()=>d("span",{class:"text-xs text-gray-500"}," 推荐使用Iconify图标，格式如：carbon:document, mdi:home, etc. ",-1)),Zt=$(()=>d("span",{class:"text-xs text-gray-500"}," 不选择任何用户类型时，所有用户都可以访问此页面；选择后，只有指定用户类型的用户才能访问 ",-1)),te=x({__name:"index",setup(n){const i=_t(),C=wt(),P=f(""),M=lt(()=>{u.page=1,g()},300),S=f([]),L=f(!1),O=f(!1),u=E({page:1,pageSize:10,itemCount:0,showSizePicker:!0,pageSizes:[10,20,30,40],onChange:o=>{u.page=o,g()},onUpdatePageSize:o=>{u.pageSize=o,u.page=1,g()}}),j=o=>o.status===0?"opacity-50":"",W=[{title:"页面标题",key:"title",width:200,render:o=>m("div",{class:"title-cell"},o.title)},{title:"页面路径",key:"path",width:200,render:o=>m("div",{class:"path-cell"},o.path)},{title:"状态",key:"status",width:100,render:o=>m(V,{type:o.status===1?"success":"error"},{default:()=>o.status===1?"启用":"禁用"})},{title:"操作",key:"actions",width:200,render:o=>m(v,{},{default:()=>[m(h,{size:"small",onClick:()=>X(o)},{default:()=>"编辑"}),m(h,{size:"small",type:"error",onClick:()=>Y(o)},{default:()=>"删除"})]})}],q=o=>{let r="";if(typeof o=="string"?r=o:r=s.path,!r)return;if(r.startsWith("http://")||r.startsWith("https://"))window.open(r,"_blank");else{const ot=window.location.origin;window.open(`${ot}${r.startsWith("/")?r:`/${r}`}`,"_blank")}},K=()=>{C.info({title:"图标使用帮助",content:`本系统使用Iconify图标库，您可以访问 https://icones.js.org/ 查找更多图标。

常用图标格式：
- carbon:document (Carbon图标集的document图标)
- mdi:home (Material Design Icons的home图标)
- icon-park:page (Icon Park的page图标)`})},g=async()=>{L.value=!0;try{const o={page:u.page,size:u.pageSize};P.value&&(o.title=P.value);const r=await Ft(o);if(!r||!r.data||!r.data.data){i.error("获取数据失败");return}const l=r.data.data;l.list?(S.value=l.list,u.itemCount=l.total||0):(S.value=[],u.itemCount=0)}catch(o){console.error("加载数据出错:",o),i.error("获取数据失败："+(o.message||"未知错误")),S.value=[],u.itemCount=0}finally{L.value=!1}},y=f(!1),B=f(""),D=f(null),R=f([]),A={id:null,title:"",path:"",type:0,icon:"carbon:document",description:"",order:0,status:1,userTypes:[]},s=E({...A}),Q={title:{required:!0,message:"请输入页面标题",trigger:"blur"},path:{required:!0,message:"请输入页面路径",trigger:"blur"}},J=()=>{Object.assign(s,A),B.value="添加页面",y.value=!0},X=o=>{Object.assign(s,o),B.value="编辑页面",y.value=!0},Y=o=>{o.id&&jt(o.id).then(()=>{i.success("删除成功"),g()})},Z=async()=>{try{const o=await ct();o&&o.data&&o.data.data&&Array.isArray(o.data.data)&&(R.value=o.data.data.filter(r=>r.status===1))}catch(o){console.error("加载用户类型失败",o),R.value=[]}},tt=nt(()=>R.value.map(o=>({label:o.name,value:o.id}))),et=async()=>{D.value&&D.value.validate(async o=>{if(!o)try{O.value=!0,s.id?(await Ht(s.id,{title:s.title,path:s.path,type:s.type,icon:s.icon,description:s.description,order:s.order,status:s.status,userTypes:s.userTypes}),i.success("更新成功")):(await Gt({title:s.title,path:s.path,type:s.type,icon:s.icon,description:s.description,order:s.order,status:s.status,userTypes:s.userTypes}),i.success("添加成功")),y.value=!1,g()}catch(r){console.error(r),i.error("操作失败")}finally{O.value=!1}})},at=o=>{u.page=o,g()};return it(()=>{g(),Z()}),(o,r)=>(z(),N("div",Wt,[d("div",qt,[e(t(ut),{title:"自定义页面管理",bordered:!1,class:"page-card"},{"header-extra":a(()=>[e(t(v),null,{default:a(()=>[e(t(k),{value:P.value,"onUpdate:value":r[0]||(r[0]=l=>P.value=l),placeholder:"搜索页面标题",clearable:"",onClear:t(M),onKeyup:dt(t(M),["enter"]),class:"search-input"},{suffix:a(()=>[e(t(h),{type:"primary",text:"",onClick:t(M)},{icon:a(()=>[e(t(_),null,{default:a(()=>[e(t(bt))]),_:1})]),_:1},8,["onClick"])]),_:1},8,["value","onClear","onKeyup"]),e(t(h),{type:"primary",onClick:J,class:"add-button"},{icon:a(()=>[e(t(_),null,{default:a(()=>[e(t(gt))]),_:1})]),default:a(()=>[w(" 添加页面 ")]),_:1})]),_:1})]),default:a(()=>[d("div",Kt,[e(t(xt),{ref:"tableRef",columns:t(W),data:S.value,loading:L.value,pagination:u,"row-class-name":j,"onUpdate:page":at,striped:"",empty:{description:"暂无数据，点击添加按钮创建新页面",icon:()=>m(t(_),{size:48},{default:()=>m(t(H))})},class:"custom-table"},null,8,["columns","data","loading","pagination","empty"])])]),_:1}),e(t(pt),{show:y.value,"onUpdate:show":r[10]||(r[10]=l=>y.value=l),title:B.value,preset:"card",style:{width:"600px"},class:"custom-modal"},{footer:a(()=>[e(t(v),{justify:"end"},{default:a(()=>[e(t(h),{onClick:r[9]||(r[9]=l=>y.value=!1)},{default:a(()=>[w("取消")]),_:1}),e(t(h),{type:"primary",onClick:et,loading:O.value},{default:a(()=>[w("确定")]),_:1},8,["loading"])]),_:1})]),default:a(()=>[e(t(Ct),{ref_key:"formRef",ref:D,model:s,rules:Q,"label-placement":"left","label-width":"auto","require-mark-placement":"right-hanging"},{default:a(()=>[e(t(b),{label:"页面标题",path:"title"},{default:a(()=>[e(t(k),{value:s.title,"onUpdate:value":r[1]||(r[1]=l=>s.title=l),placeholder:"请输入页面标题"},null,8,["value"])]),_:1}),e(t(b),{label:"页面路径",path:"path"},{help:a(()=>[Qt]),default:a(()=>[e(t(G),null,{default:a(()=>[e(t(k),{value:s.path,"onUpdate:value":r[2]||(r[2]=l=>s.path=l),placeholder:"请输入页面路径，外部链接需要带http(s)://"},null,8,["value"]),e(t(h),{type:"primary",ghost:"",onClick:q,disabled:!s.path},{icon:a(()=>[e(t(_),null,{default:a(()=>[e(t(St))]),_:1})]),default:a(()=>[w(" 预览 ")]),_:1},8,["disabled"])]),_:1})]),_:1}),e(t(b),{label:"页面类型",path:"type"},{default:a(()=>[e(t(F),{value:s.type,"onUpdate:value":r[3]||(r[3]=l=>s.type=l)},{default:a(()=>[e(t(v),null,{default:a(()=>[e(t(T),{value:0},{default:a(()=>[e(t(v),{align:"center"},{default:a(()=>[e(t(_),null,{default:a(()=>[e(t(Bt))]),_:1}),Jt]),_:1})]),_:1}),e(t(T),{value:1},{default:a(()=>[e(t(v),{align:"center"},{default:a(()=>[e(t(_),null,{default:a(()=>[e(t(H))]),_:1}),Xt]),_:1})]),_:1})]),_:1})]),_:1},8,["value"])]),_:1}),e(t(b),{label:"页面图标",path:"icon"},{help:a(()=>[Yt]),default:a(()=>[e(t(G),null,{default:a(()=>[e(t(k),{value:s.icon,"onUpdate:value":r[4]||(r[4]=l=>s.icon=l),placeholder:"请输入图标名称"},null,8,["value"]),e(t(h),{text:"",onClick:K},{default:a(()=>[e(t(_),null,{default:a(()=>[e(t(Et))]),_:1})]),_:1})]),_:1})]),_:1}),e(t(b),{label:"描述信息",path:"description"},{default:a(()=>[e(t(k),{value:s.description,"onUpdate:value":r[5]||(r[5]=l=>s.description=l),type:"textarea",placeholder:"请输入描述信息"},null,8,["value"])]),_:1}),e(t(b),{label:"排序值",path:"order"},{default:a(()=>[e(t(vt),{value:s.order,"onUpdate:value":r[6]||(r[6]=l=>s.order=l),placeholder:"数字越小越靠前"},null,8,["value"])]),_:1}),e(t(b),{label:"状态",path:"status"},{default:a(()=>[e(t(F),{value:s.status,"onUpdate:value":r[7]||(r[7]=l=>s.status=l)},{default:a(()=>[e(t(v),null,{default:a(()=>[e(t(T),{value:1},{default:a(()=>[e(t(V),{type:"success"},{default:a(()=>[w("启用")]),_:1})]),_:1}),e(t(T),{value:0},{default:a(()=>[e(t(V),{type:"error"},{default:a(()=>[w("禁用")]),_:1})]),_:1})]),_:1})]),_:1},8,["value"])]),_:1}),e(t(b),{label:"用户类型限制",path:"userTypes"},{help:a(()=>[Zt]),default:a(()=>[e(t(yt),{value:s.userTypes,"onUpdate:value":r[8]||(r[8]=l=>s.userTypes=l),options:tt.value,multiple:"",placeholder:"请选择可访问的用户类型，不选则所有用户可访问"},null,8,["value","options"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show","title"])])]))}}),pe=ht(te,[["__scopeId","data-v-4a4e4f3b"]]);export{pe as default};
