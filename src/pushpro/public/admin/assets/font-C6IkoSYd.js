
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.github.io
 */

import{J as h,d as we,r as _,m as B,a as he,p as i,q as ye,g as b,c as S,b as l,w as a,_ as Ve,j as Ce,h as d,x as J,F as L,s as j,e as m,z as ke,v as A,t as O,A as Se,G as p,N as X,I as xe,W as Ue,X as ze,l as Fe,k as Q}from"./index-CnisIzlN.js";import{_ as $e}from"./index.vue_vue_type_script_setup_true_lang-BkBSJsBX.js";function De(s){return h({url:"/font",method:"get",params:s})}function Te(s){return h({url:"/font",method:"post",data:s})}function Ie(s,V){return h({url:`/font/${s}`,method:"patch",data:V})}function Pe(s){return h({url:`/font/${s}`,method:"delete"})}function Be(s){return h({url:"/font/batch-remove",method:"post",data:s})}function Le(s){return h({url:`/font/${s}/toggle-status`,method:"patch"})}function je(){return h({url:"/font/fetch-from-api",method:"get"})}const Y=s=>(Ue("data-v-8cb80160"),s=s(),ze(),s),Ae=Y(()=>m("div",{class:"flex items-center gap-4"},"字体管理",-1)),Oe=Y(()=>m("div",{class:"text-sm/6"},[m("div",null," 管理系统字体库，支持添加、编辑和删除字体，以及从API获取字体数据。 ")],-1)),Re={class:"mb-4 flex justify-between"},Me={class:"thumbnail-container"},Ne={key:1,class:"no-thumbnail"},qe={class:"pagination-container"},Ee={class:"flex justify-center"},Ke={class:"dialog-footer"},We={class:"font-preview-container"},Ge=["src"],Z=we({__name:"font",setup(s){const V=_(),C=_(!1),z=_(!1),k=_(!1),x=_([]),y=_([]),F=_(!1),$=_(!1),R=_(""),ee=_("字体预览"),M=o=>{R.value=o,$.value=!0},f=B({name:"",code:"",type:null,status:null,page:1,pageSize:10}),r=B({page:1,pageSize:10,itemCount:0,pageSizes:[10,20,30,50]}),N={id:null,name:"",code:"",preview:"",url:"",type:"ttf",status:!0,sort:0,source:"manual",remark:""},n=B({...N}),le={name:[{required:!0,message:"请输入字体名称",trigger:"blur"}],code:[{required:!0,message:"请输入字体代码",trigger:"blur"}],url:[{required:!0,message:"请输入字体文件URL",trigger:"blur"}]},q=[{label:"TTF",value:"ttf"},{label:"OTF",value:"otf"},{label:"WOFF",value:"woff"},{label:"WOFF2",value:"woff2"}],te=[{label:"启用",value:!0},{label:"禁用",value:!1}],v=async()=>{C.value=!0;try{const o={...f,page:r.page,pageSize:r.pageSize},t=await De(o);t&&t.data&&t.data.items?(x.value=t.data.items,r.itemCount=t.data.total):(x.value=[],r.itemCount=0)}catch(o){console.error("获取字体列表失败:",o),p.error("获取字体列表失败"),x.value=[],r.itemCount=0}finally{C.value=!1}},D=(o=null)=>{o?(F.value=!0,Object.assign(n,o)):(F.value=!1,Object.assign(n,{...N})),k.value=!0},ae=async()=>{if(V.value)try{await V.value.validate(),z.value=!0,F.value&&n.id!==null?(await Ie(n.id,n),p.success("更新成功")):(await Te(n),p.success("创建成功")),k.value=!1,v()}catch(o){console.error("保存失败:",o),p.error("保存失败")}finally{z.value=!1}},oe=o=>{X.confirm(`确定要删除字体 "${o.name}" 吗？`,"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{await Pe(o.id),p.success("删除成功"),v()}catch(t){console.error("删除失败:",t),p.error("删除失败")}}).catch(()=>{})},ne=()=>{if(!y.value.length){p.warning("请选择要删除的字体");return}X.confirm(`确定要删除选中的 ${y.value.length} 个字体吗？`,"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{await Be(y.value),p.success("批量删除成功"),y.value=[],v()}catch(o){console.error("批量删除失败:",o),p.error("批量删除失败")}}).catch(()=>{})},se=async o=>{try{await Le(o.id),p.success("状态更新成功"),o.status=!o.status}catch(t){console.error("状态更新失败:",t),p.error("状态更新失败")}},re=async()=>{try{C.value=!0;const o=await je();p.success(`成功从API获取字体数据: ${o.message||"数据已更新"}`),v()}catch(o){console.error("从API获取字体数据失败:",o),p.error("从API获取字体数据失败")}finally{C.value=!1}},T=()=>{r.page=1,v()},ue=()=>{Object.assign(f,{name:"",code:"",type:null,status:null}),r.page=1,v()},ie=()=>{v()},de=o=>{y.value=o.map(t=>t.id)},pe=o=>{r.page=o,v()},ce=o=>{r.pageSize=o,r.page=1,v()};return he(()=>{v()}),(o,t)=>{const me=$e,w=i("el-input"),u=i("el-form-item"),I=i("el-option"),P=i("el-select"),g=i("el-button"),E=i("el-form"),K=xe,c=i("el-table-column"),W=i("el-image"),fe=i("el-tag"),G=i("el-switch"),ve=i("el-table"),ge=i("el-pagination"),_e=i("el-input-number"),H=i("el-dialog"),be=ye("loading");return b(),S("div",null,[l(me,null,{title:a(()=>[Ae]),content:a(()=>[Oe]),default:a(()=>[l(Ve,{outline:"",type:"success",onClick:t[0]||(t[0]=e=>D())},{default:a(()=>[l(Ce,{name:"i-ri:font-size-2"}),d(" 新增字体 ")]),_:1})]),_:1}),l(K,null,{default:a(()=>[l(E,{inline:!0,model:f},{default:a(()=>[l(u,{label:"字体名称"},{default:a(()=>[l(w,{modelValue:f.name,"onUpdate:modelValue":t[1]||(t[1]=e=>f.name=e),placeholder:"请输入字体名称",clearable:"",onKeyup:J(T,["enter"])},null,8,["modelValue"])]),_:1}),l(u,{label:"字体代码"},{default:a(()=>[l(w,{modelValue:f.code,"onUpdate:modelValue":t[2]||(t[2]=e=>f.code=e),placeholder:"请输入字体代码",clearable:"",onKeyup:J(T,["enter"])},null,8,["modelValue"])]),_:1}),l(u,{label:"字体类型"},{default:a(()=>[l(P,{modelValue:f.type,"onUpdate:modelValue":t[3]||(t[3]=e=>f.type=e),placeholder:"请选择字体类型",clearable:"",style:{width:"160px"}},{default:a(()=>[(b(),S(L,null,j(q,e=>l(I,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),l(u,{label:"状态"},{default:a(()=>[l(P,{modelValue:f.status,"onUpdate:modelValue":t[4]||(t[4]=e=>f.status=e),placeholder:"请选择状态",clearable:"",style:{width:"160px"}},{default:a(()=>[(b(),S(L,null,j(te,e=>l(I,{key:String(e.value),label:e.label,value:e.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),l(u,null,{default:a(()=>[l(g,{type:"primary",onClick:T},{default:a(()=>[d("搜索")]),_:1}),l(g,{onClick:ue},{default:a(()=>[d("重置")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),l(K,{style:{width:"100%"}},{default:a(()=>[m("div",Re,[m("div",null,[l(g,{type:"primary",onClick:t[5]||(t[5]=e=>D())},{default:a(()=>[d("新增字体")]),_:1}),l(g,{type:"danger",disabled:!y.value.length,onClick:ne},{default:a(()=>[d("批量删除")]),_:1},8,["disabled"]),l(g,{type:"info",onClick:re},{default:a(()=>[d("从API获取字体数据")]),_:1})]),m("div",null,[l(g,{type:"primary",onClick:ie},{default:a(()=>[d("刷新")]),_:1})])]),ke((b(),A(ve,{data:x.value,border:"",style:{width:"100%"},onSelectionChange:de},{default:a(()=>[l(c,{type:"selection",width:"55"}),l(c,{prop:"id",label:"ID",width:"80"}),l(c,{prop:"name",label:"字体名称",width:"160","show-overflow-tooltip":""}),l(c,{prop:"code",label:"字体代码",width:"160","show-overflow-tooltip":""}),l(c,{label:"预览图",width:"120"},{default:a(e=>[m("div",Me,[e.row.preview?(b(),A(W,{key:0,src:e.row.preview,fit:"contain",class:"font-preview-image",onClick:U=>M(e.row.preview)},null,8,["src","onClick"])):(b(),S("div",Ne,"无"))])]),_:1}),l(c,{label:"字体类型",width:"100"},{default:a(e=>[l(fe,{size:"small"},{default:a(()=>[d(O(e.row.type),1)]),_:2},1024)]),_:1}),l(c,{prop:"sort",label:"排序",width:"80"}),l(c,{label:"状态",width:"100"},{default:a(e=>[l(G,{modelValue:e.row.status,"onUpdate:modelValue":U=>e.row.status=U,onChange:()=>se(e.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),l(c,{prop:"source",label:"来源",width:"100"}),l(c,{label:"创建时间",width:"160"},{default:a(e=>[d(O(new Date(e.row.createTime).toLocaleString()),1)]),_:1}),l(c,{label:"更新时间",width:"160"},{default:a(e=>[d(O(new Date(e.row.updateTime).toLocaleString()),1)]),_:1}),l(c,{label:"操作",width:"150",fixed:"right"},{default:a(e=>[l(g,{type:"primary",size:"small",onClick:U=>D(e.row)},{default:a(()=>[d("编辑")]),_:2},1032,["onClick"]),l(g,{type:"danger",size:"small",onClick:U=>oe(e.row)},{default:a(()=>[d("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[be,C.value]]),m("div",qe,[l(ge,{currentPage:r.page,"onUpdate:currentPage":t[6]||(t[6]=e=>r.page=e),"page-size":r.pageSize,"onUpdate:pageSize":t[7]||(t[7]=e=>r.pageSize=e),"page-sizes":r.pageSizes,total:r.itemCount,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:ce,onCurrentChange:pe},null,8,["currentPage","page-size","page-sizes","total"])]),l(H,{modelValue:k.value,"onUpdate:modelValue":t[18]||(t[18]=e=>k.value=e),title:"字体信息",width:"600px","close-on-click-modal":!1},{footer:a(()=>[m("div",Ke,[l(g,{onClick:t[17]||(t[17]=e=>k.value=!1)},{default:a(()=>[d("取消")]),_:1}),l(g,{type:"primary",loading:z.value,onClick:ae},{default:a(()=>[d("确定")]),_:1},8,["loading"])])]),default:a(()=>[l(E,{ref_key:"formRef",ref:V,model:n,rules:le,"label-width":"100px",class:"py-4"},{default:a(()=>[l(u,{label:"字体名称",prop:"name"},{default:a(()=>[l(w,{modelValue:n.name,"onUpdate:modelValue":t[8]||(t[8]=e=>n.name=e),placeholder:"请输入字体名称"},null,8,["modelValue"])]),_:1}),l(u,{label:"字体代码",prop:"code"},{default:a(()=>[l(w,{modelValue:n.code,"onUpdate:modelValue":t[9]||(t[9]=e=>n.code=e),placeholder:"请输入字体代码"},null,8,["modelValue"])]),_:1}),l(u,{label:"预览图URL",prop:"preview"},{default:a(()=>[l(w,{modelValue:n.preview,"onUpdate:modelValue":t[10]||(t[10]=e=>n.preview=e),placeholder:"请输入预览图URL"},null,8,["modelValue"])]),_:1}),n.preview?(b(),A(u,{key:0,label:"预览图"},{default:a(()=>[m("div",Ee,[l(W,{src:n.preview,class:"max-h-40 object-contain",onClick:t[11]||(t[11]=e=>M(n.preview))},null,8,["src"])])]),_:1})):Se("",!0),l(u,{label:"字体文件URL",prop:"url"},{default:a(()=>[l(w,{modelValue:n.url,"onUpdate:modelValue":t[12]||(t[12]=e=>n.url=e),placeholder:"请输入字体文件URL"},null,8,["modelValue"])]),_:1}),l(u,{label:"字体类型",prop:"type"},{default:a(()=>[l(P,{modelValue:n.type,"onUpdate:modelValue":t[13]||(t[13]=e=>n.type=e),placeholder:"请选择字体类型",style:{width:"100%"}},{default:a(()=>[(b(),S(L,null,j(q,e=>l(I,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),l(u,{label:"排序",prop:"sort"},{default:a(()=>[l(_e,{modelValue:n.sort,"onUpdate:modelValue":t[14]||(t[14]=e=>n.sort=e),placeholder:"请输入排序值"},null,8,["modelValue"])]),_:1}),l(u,{label:"状态",prop:"status"},{default:a(()=>[l(G,{modelValue:n.status,"onUpdate:modelValue":t[15]||(t[15]=e=>n.status=e)},null,8,["modelValue"])]),_:1}),l(u,{label:"备注",prop:"remark"},{default:a(()=>[l(w,{modelValue:n.remark,"onUpdate:modelValue":t[16]||(t[16]=e=>n.remark=e),type:"textarea",placeholder:"请输入备注"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),l(H,{modelValue:$.value,"onUpdate:modelValue":t[19]||(t[19]=e=>$.value=e),title:ee.value,width:"500px","close-on-click-modal":!0,class:"font-preview-dialog"},{default:a(()=>[m("div",We,[m("img",{src:R.value,class:"font-preview-large"},null,8,Ge)])]),_:1},8,["modelValue","title"])]),_:1})])}}});typeof Q=="function"&&Q(Z);const Xe=Fe(Z,[["__scopeId","data-v-8cb80160"]]);export{Xe as default};
