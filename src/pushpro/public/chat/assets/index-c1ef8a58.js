import{a as k,b as I}from"./invitation-89f85132.js";import{d as N,m as w}from"./index-e8e306c5.js";import{d as A}from"./avatar-1774e43b.js";import{d as C,F as S,y as p,S as B,K as v,I as V,M as D,A as T,D as z}from"./naive-ui-5426aa23.js";import{d as G,r as i,f as M,R as P,U as R,V as o,L as t,W as a,a2 as n,c as U,l as j,ab as q,ac as F}from"./vue-f337fce5.js";import{_ as H}from"./_plugin-vue_export-helper-c27b6911.js";import"./vueuse-motion-2f7a1d90.js";const u=l=>(q("data-v-b48f9a75"),l=l(),F(),l),K={class:"flex justify-between items-center"},W={class:"flex items-center"},E=u(()=>n("div",{class:"i-carbon:arrow-left text-xl"},null,-1)),J=u(()=>n("h1",{class:"text-xl font-bold ml-2"},"我的邀请",-1)),O={class:"flex items-center space-x-4"},Q=u(()=>n("div",{class:"mt-4 text-gray-500 text-sm"}," 发送此链接给您的朋友，当他们通过此链接注册账户时，会自动成为您邀请的用户。 ",-1)),X=G({__name:"index",setup(l){const m=N(),d=w(),s=C();i(m.isLogin).value||d.replace("/");const r=i(""),f=i([]),c=i(!0),h=[{title:"用户头像",key:"avatar",render:e=>j(z,{size:"small",round:!0,src:e.avatar||A})},{title:"用户名",key:"username"},{title:"注册时间",key:"createdAt"},{title:"账户状态",key:"status",render:e=>e.status===1?"正常":"禁用"}];async function y(){try{const e=await k();e.code===200&&e.success?r.value=e.data:s.error({title:"获取失败",content:e.message||"获取邀请链接失败"})}catch(e){console.error("获取邀请链接错误:",e),s.error({title:"获取失败",content:"获取邀请链接失败"})}}function x(){if(!r.value){s.error({title:"复制失败",content:"邀请链接为空"});return}navigator.clipboard.writeText(r.value).then(()=>{s.success({title:"复制成功",content:"邀请链接已复制到剪贴板！"})}).catch(()=>{s.error({title:"复制失败",content:"请手动复制: "+r.value})})}async function g(){try{c.value=!0;const e=await I();e.code===200&&e.success?f.value=e.data||[]:s.error({title:"获取失败",content:e.message||"获取邀请用户列表失败"})}catch(e){console.error("获取邀请列表错误:",e),s.error({title:"获取失败",content:"获取邀请用户列表失败"})}finally{c.value=!1}}function L(){d.push("/chat")}return M(()=>{y(),g()}),(e,_)=>(P(),R(t(S),{class:"h-full"},{default:o(()=>[a(t(B),{bordered:"",class:"header-container p-5"},{default:o(()=>[n("div",K,[n("div",W,[a(t(p),{quaternary:"",onClick:L},{icon:o(()=>[E]),_:1}),J])])]),_:1}),a(t(T),{class:"p-6"},{default:o(()=>[a(t(v),{title:"我的邀请链接",class:"mb-6"},{default:o(()=>[n("div",O,[a(t(V),{value:r.value,"onUpdate:value":_[0]||(_[0]=b=>r.value=b),readonly:"",placeholder:"获取邀请链接中...",class:"flex-1"},null,8,["value"]),a(t(p),{type:"primary",onClick:x},{default:o(()=>[U(" 复制链接 ")]),_:1})]),Q]),_:1}),a(t(v),{title:"我邀请的用户"},{default:o(()=>[a(t(D),{loading:c.value,columns:h,data:f.value,bordered:!1,size:"small","single-line":!1,striped:"","empty-text":"暂无邀请用户"},null,8,["loading","data"])]),_:1})]),_:1})]),_:1}))}});const re=H(X,[["__scopeId","data-v-b48f9a75"]]);export{re as default};
