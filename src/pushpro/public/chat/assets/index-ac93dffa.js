import{m as f,n as _,d as g,_ as h}from"./index-e8e306c5.js";import{i as w,j as p}from"./user-56b50a15.js";import{d as L,e as i,r as v,f as y,w as P,R as C,S as x,a2 as b}from"./vue-f337fce5.js";import{_ as A}from"./_plugin-vue_export-helper-c27b6911.js";import"./naive-ui-5426aa23.js";import"./vueuse-motion-2f7a1d90.js";const R={class:"iframe-container"},S=L({__name:"index",setup(k){const n=f();_();const a=g(),r=i(()=>a.isLogin);i(()=>{var o;return Number((o=a.globalConfig)==null?void 0:o.wechatSilentLoginStatus)===1});const s=v(null);async function u(){const t=new URLSearchParams(window.location.search).getAll("code");if(!(t.length>0?t[t.length-1]:null)){const c=window.location.href.split("#")[0],l=await p({url:c});l.success&&(window.location.href=l.data)}}async function d(){const t=new URLSearchParams(window.location.search).getAll("code"),e=t.length>0?t[t.length-1]:null;if(e){const c=await w({code:e});c.success&&(a.setToken(c.data),await a.getUserInfo(),a.setLoginDialog(!1),n.replace("/chat"))}}async function m(){window.navigator.userAgent.toLowerCase().includes("micromessenger")&&await u()}return y(async()=>{var t;if(r.value){n.replace("/chat");return}let o=i(()=>{var e;return((e=a.globalConfig)==null?void 0:e.homeHtml)||""});if(o=i(()=>{var e;return`
    ${((e=a.globalConfig)==null?void 0:e.homeHtml)||""}
  `}),s.value){const e=s.value.contentDocument||((t=s.value.contentWindow)==null?void 0:t.document);e&&(e.open(),e.write(o.value),e.close())}h(()=>import("./chat-973aafd5.js"),["./chat-973aafd5.js","./useBasicLayout-ad7b6f42.js","./vue-f337fce5.js","./index-e8e306c5.js","./naive-ui-5426aa23.js","./vueuse-motion-2f7a1d90.js","./index-9071fadf.css","./index-ac008ee1.js","./main-0abeda67.js","./_plugin-vue_export-helper-c27b6911.js","./index-79cb522c.js","./xhs-06219a15.js","./index-488e0040.css","./index-3c05536f.js","./index-12e2c381.css","./index-761141fd.js","./index-14c16943.css","./index-cf9af2d6.js","./index-448232be.css","./index-6b34c72f.js","./index-3dffedb6.css","./index-1ca00ffc.js","./index-a6e70ae2.css","./invitation-89f85132.js","./chat-60b761e0.css"],import.meta.url),window.addEventListener("message",async e=>{e.data==="goToChat"&&(await d(),n.replace("/chat")),e.data==="goToLogin"&&a.setLoginDialog(!0)}),await m()}),P(r,o=>{o&&n.replace("/chat")}),(o,t)=>(C(),x("div",R,[b("iframe",{ref_key:"iframe",ref:s,class:"iframe",frameborder:"0"},null,512)]))}});const W=A(S,[["__scopeId","data-v-bc827095"]]);export{W as default};
